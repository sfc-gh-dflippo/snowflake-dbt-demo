trigger: none

pool:
  vmImage: 'ubuntu-latest'
container:
  image: ghcr.io/dbt-labs/dbt-snowflake:1.6.0
  options: --entrypoint=""

  env:
    SNOWFLAKE_ACCOUNT: aws_cas2
    SNOWFLAKE_USER: DFLIPPO
    SNOWFLAKE_ROLE: DFLIPPO_ROLE
    SNOWFLAKE_WAREHOUSE: DFLIPPO_WH
    SNOWFLAKE_DATABASE: DFLIPPO_DEV
    SNOWFLAKE_SCHEMA: DBT_DEMO
    SNOWFLAKE_THREADS: 8
    SNOWFLAKE_QUERY_TAG: DBT-DEMO
    DBT_ENV_SECRET_PRIVATE_KEY: $(DBT_ENV_SECRET_PRIVATE_KEY)
    DBT_PROFILES_DIR: ./docker

steps:
- checkout: self
- bash: |
    dbt deps
    dbt build
  displayName: 'Run dbt'
